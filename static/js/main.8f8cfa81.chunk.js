(this["webpackJsonptype-racer-game"]=this["webpackJsonptype-racer-game"]||[]).push([[0],{52:function(e,t,n){e.exports={app:"app_app__2ENaR","game-result-overlay":"app_game-result-overlay__2Xrou","game-result":"app_game-result__29UlW"}},53:function(e,t,n){e.exports={wrapper:"login-form_wrapper__3CY0p",error:"login-form_error__6l6W8"}},61:function(e,t,n){e.exports={"guide-text":"guide-text_guide-text__2R-TK"}},65:function(e,t,n){e.exports={dashboard:"dashboard_dashboard__IPU-I"}},71:function(e,t,n){},72:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n(1),a=n.n(s),i=n(60),c=n.n(i),o=(n(71),n(37)),l=n(38),h=n(48),u=n(46),d=n(52),j=n.n(d),m=n(61),b=n.n(m),g=function(e){var t=e.data,n=e.highlightedText;return Object(r.jsx)("section",{className:b.a["guide-text"],children:n.length?Object(r.jsxs)("p",{children:[Object(r.jsx)("mark",{children:n}),t.replace(n,"")]}):Object(r.jsx)("p",{children:t})})},x=(n(72),function(e){var t=e.value,n=e.onChangeHandler;return Object(r.jsx)("textarea",{onKeyPress:n,onChange:function(){},autoFocus:!0,rows:"7",placeholder:"Start typing here!",value:t})}),p=function(e,t){return window.firebase.auth().signInWithEmailAndPassword(e,t)},O=function(){return window.firebase.auth().signOut()},f=function(e){window.firebase.database().ref("history/").push().set(e,(function(e){return e&&console.log(e)}))},v=function(){return window.firebase.database().ref("/history/").once("value")},w=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={srcText:"",textAreaValue:"",currentIndex:0,timer:0,timerDisplay:"3:00",gameDone:!1,isLoading:!0,error:null},e.startTimer=function(){var t=e.state.timerDisplay.split(/[:]+/),n=t[0],r=e.checkSecond(t[1]-1);59===+r&&(n-=1),e.setState({timer:e.state.timer+1,timerDisplay:"".concat(n,":").concat(r)}),0===+n&&0===+r&&e.gameFinish()},e.checkSecond=function(e){return e<10&&e>=0&&(e="0"+e),e<0&&(e="59"),e},e.handleRequestError=function(t){if(t.ok)return t.json();e.setState({error:"Error from the response.",isLoading:!1})},e.handleKeypress=function(t){var n=e.state,r=n.srcText,s=n.currentIndex,a=n.textAreaValue;t.key===r[s]&&s<r.length&&e.setState({currentIndex:s+1,textAreaValue:a+t.key}),a.length===r.length&&e.gameFinish()},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"startGame",value:function(){var e=this,t=setInterval((function(){e.startTimer(),e.state.gameDone&&clearInterval(t)}),1e3)}},{key:"gameFinish",value:function(){var e=this.state,t=e.textAreaValue,n=e.timer,r=e.srcText,s=Math.floor(t.length/5),a=Math.ceil(s/(n/60)),i=t.length/r.length*100,c="".concat(i%1!==0?i.toFixed(2):i,"%");this.setState({gameDone:!0}),this.saveGameDetails(c,a),this.props.onGameDone(c,a)}},{key:"saveGameDetails",value:function(e,t){f({userId:window.firebase.auth().currentUser.uid,wpm:t,completion:e,actualTime:this.state.timer,date:(new Date).toString()})}},{key:"fetchData",value:function(){var e=this;fetch("https://baconipsum.com/api/?type=meat&paras=3").then(this.handleRequestError).then((function(t){e.setState({srcText:t[0].replace("  "," "),isLoading:!1}),e.startGame()})).catch((function(t){e.setState({error:"Something went wrong, please check your connection",isLoading:!1})}))}},{key:"renderContent",value:function(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{style:{textAlign:"center"},children:this.state.timerDisplay}),Object(r.jsx)(g,{data:this.state.srcText,highlightedText:this.state.textAreaValue}),Object(r.jsx)(x,{value:this.state.textAreaValue,onChangeHandler:this.handleKeypress})]})}},{key:"render",value:function(){var e=this.state,t=e.srcText,n=e.error,s=e.isLoading;return t?this.renderContent():s?Object(r.jsx)("em",{children:"loading ..."}):n?Object(r.jsx)("em",{style:{color:"red"},children:n}):Object(r.jsx)("em",{children:"Something went wrong!"})}}]),n}(a.a.Component),y=n(24),S=n(54),k=n(53),D=n.n(k),I=function(e){var t=e.handleLogin,n=e.errorMessage;return Object(r.jsx)("div",{className:D.a.wrapper,children:Object(r.jsx)(y.d,{initialValues:{email:"",password:""},validationSchema:S.a({email:S.b().email("Invalid email address.").required("Email is required."),password:S.b().min(6,"Must at least 6 character.").required("Password is required.")}),onSubmit:function(e,n){var r=n.setSubmitting;setTimeout((function(){t(e),r(!1)}),400)},children:Object(r.jsxs)(y.c,{children:[Object(r.jsx)("h3",{children:"Please login to proceed."}),Object(r.jsx)("hr",{}),n&&Object(r.jsx)("p",{style:{color:"red"},children:n}),Object(r.jsxs)("div",{children:[Object(r.jsx)(y.b,{placeholder:"Email address",name:"email",type:"email",autoFocus:!0}),Object(r.jsx)("span",{className:D.a.error,children:Object(r.jsx)(y.a,{name:"email"})})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)(y.b,{placeholder:"Password",name:"password",type:"password"}),Object(r.jsx)("span",{className:D.a.error,children:Object(r.jsx)(y.a,{name:"password"})})]}),Object(r.jsx)("button",{type:"submit",children:"Submit"})]})})})},A=n(59),T=n(58),_=n(65),C=n.n(_),L=void 0,E=function(e){var t=e.onGameStart,n=Object(s.useState)([]),a=Object(T.a)(n,2),i=a[0],c=a[1],o=Object(s.useState)(!0),l=Object(T.a)(o,2),h=l[0],u=l[1];return Object(s.useEffect)((function(){var e=!0;return v().then((function(t){var n=t.val(),r=[];u(!1),e&&n&&(Object.keys(n).forEach((function(e){return r.push(Object(A.a)(Object(A.a)({},n[e]),{},{id:e}))})),c(r.filter((function(e){return e.userId===window.firebase.auth().currentUser.uid})).sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()}))))})).catch((function(e){return console.log(e)})),function(){return e=!1}})),Object(r.jsxs)("div",{className:C.a.dashboard,children:[Object(r.jsxs)("div",{children:[Object(r.jsxs)("span",{children:[window.firebase.auth().currentUser.email," |"," ",Object(r.jsx)("button",{onClick:G,children:"Logout"})]}),Object(r.jsx)("h1",{children:"Type Racer game"}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:"Each game has 3 minutes to complete."}),Object(r.jsx)("li",{children:"Each will show the game result one finished."}),Object(r.jsx)("li",{children:"Once the start button is triggered, the timer will start."}),Object(r.jsx)("li",{children:"Once done ahead of given time, please press enter to submit"})]}),Object(r.jsxs)("h3",{children:["Test your typing skills"," ",Object(r.jsx)("button",{onClick:t,children:"Start Now!"})]})]}),i.length?Object(r.jsx)(M,{historyList:i}):h?Object(r.jsx)("em",{children:"loading ..."}):Object(r.jsx)(r.Fragment,{children:"Game history is empty."})]})},M=function(e){var t=e.historyList;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Game history"}),Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Actual Time (Seconds)"}),Object(r.jsx)("th",{children:"Completed %"}),Object(r.jsx)("th",{children:"Words per minute (WPM)"}),Object(r.jsx)("th",{children:"Date"})]})}),Object(r.jsx)("tbody",{children:t.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:e.actualTime}),Object(r.jsx)("td",{children:e.completion}),Object(r.jsx)("td",{children:e.wpm}),Object(r.jsxs)("td",{children:[new Date(e.date).toLocaleDateString()," ",new Date(e.date).toLocaleTimeString()]})]},e.id)}))})]})]})},G=function(){O().then((function(){return console.log("successfully signed out!")})).catch((function(e){return L.setState({errorMessage:e.message})}))},F=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).handleLogin=function(e){p(e.email,e.password).then((function(){return r.setState({isSignedIn:!0,errorMessage:""})})).catch((function(e){return r.setState({loginErrorMessage:e.message})}))},r.startGame=function(){r.setState({isIdle:!1})},r.gameDone=function(e,t){r.setState({isIdle:!0,totalAverage:e,wpm:t})},r.closeResult=function(){r.setState({wpm:0,totalAverage:0})},r.state={isSignedIn:void 0,isIdle:!0,loginErrorMessage:"",totalAverage:0,wpm:0},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.onAuthStateChange()}},{key:"componentWillUnmount",value:function(){this.fireBaseListener&&this.fireBaseListener(),this.onAuthStateChange=void 0}},{key:"onAuthStateChange",value:function(){var e=this;this.fireBaseListener=window.firebase.auth().onAuthStateChanged((function(t){return e.setState({isSignedIn:!!t})}))}},{key:"renderResult",value:function(){var e=this;return Object(r.jsx)("div",{className:j.a["game-result-overlay"],children:Object(r.jsxs)("div",{className:j.a["game-result"],children:[Object(r.jsx)("h3",{children:"Game Result:"}),Object(r.jsxs)("div",{children:[Object(r.jsxs)("span",{children:["Completed: ",Object(r.jsx)("strong",{children:this.state.totalAverage})]}),Object(r.jsxs)("span",{children:["WPM Average: ",Object(r.jsx)("strong",{children:this.state.wpm})]})]}),Object(r.jsx)("button",{onClick:function(){return e.setState({isIdle:!1})},children:"Try Again"}),Object(r.jsx)("button",{onClick:this.closeResult,children:"Close"})]})})}},{key:"render",value:function(){return Object(r.jsx)("main",{className:j.a.app,children:void 0===this.state.isSignedIn?Object(r.jsx)("em",{children:"loading ..."}):this.state.isSignedIn&&this.state.isIdle?Object(r.jsxs)(r.Fragment,{children:[this.state.wpm&&this.state.totalAverage?this.renderResult():null,Object(r.jsx)(E,{onGameStart:this.startGame})]}):this.state.isSignedIn&&!this.state.isIdle?Object(r.jsx)(w,{onGameDone:this.gameDone}):Object(r.jsx)(I,{handleLogin:this.handleLogin,errorMessage:this.state.loginErrorMessage})})}}]),n}(a.a.Component);c.a.render(Object(r.jsx)(F,{}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.8f8cfa81.chunk.js.map